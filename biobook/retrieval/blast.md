# The BLAST Algorithm for Sequence Retrieval

## Introduction

BLAST (Basic Local Alignment Search Tool) is a powerful algorithm designed for comparing biological sequences, such as protein amino acid sequences or DNA/RNA nucleotide sequences. Developed by Eugene Myers, Stephen Altschul, Warren Gish, David J. Lipman, and Webb Miller at the National Institutes of Health (NIH) in 1990, BLAST has become one of the most widely used tools in bioinformatics.

The primary purpose of BLAST is to compare a query sequence against a database of sequences, identifying those with a similarity above a certain threshold. This enables researchers to efficiently find sequences that resemble the query, facilitating further biological research.

## Background and Development

BLAST was designed to address a fundamental challenge in bioinformatics: how to efficiently search large genomic databases. Its heuristic algorithm offers a much faster alternative to traditional methods like Smith-Waterman and Needleman-Wunsch, which focus on optimal alignment but are computationally intensive.

BLAST's success and widespread adoption stem from its balance of speed and sensitivity, making it an essential tool for biological research. Its development was also supported by a novel stochastic model created by Samuel Karlin and Stephen Altschul, forming the statistical foundation for the tool.

### Input

BLAST takes in a query sequence, either in FASTA or GenBank format, along with a target database and optional parameters such as a scoring matrix.

### Output

BLAST provides results in various formats, including HTML, plain text, and XML. The results include a graphical representation of hits, a table with scoring data, and individual alignments between the query and matched sequences. The table format is particularly useful, summarizing information about each hit.

The Basic Local Alignment Search Tool (BLAST) is a widely used algorithm for searching and retrieving sequences from biological databases. It performs efficient searches by identifying regions of similarity between a query sequence and database sequences, making it an essential tool in bioinformatics. This chapter explores the fundamental concepts behind BLAST and its key components.

```{note} What is a k-mer?

Before we describe the details of BLAST we need to describe the concept of k-mers. A k-mer is a contiguous substring of length k derived from a larger sequence:

- **Generation**: K-mers are generated by sliding a window of length k across a sequence, creating overlapping substrings.
- **Examples**: For a DNA sequence "AGCTAGC", 3-mers (k=3) would include "AGC", "GCT", "CTA", etc.
- **Importance**: K-mers are useful for representing sequences, identifying sequence patterns, and conducting sequence comparisons.

K-mers can be used for indexing sequences, making sequence retrieval more efficient:

- **Hash Table Creation**: A hash table or other data structure can store k-mers as keys, mapping them to sequence locations.
- **Fast Lookups**: By indexing k-mers from database sequences, BLAST can quickly look up similar k-mers from the query sequence, avoiding the need for a full pairwise alignment.
- **Word Hits**: K-mer matches between the query and database sequences, termed "word hits," serve as initial points of comparison for BLAST.
```

## The BLAST Algorithm

The BLAST algorithm follows these key steps:

1. **Word Hits Generation**: The query sequence is broken into k-mers, and these are compared to pre-computed k-mers from the database sequences.

1. **Seeding**: The match k-mers, known as "seeds", are used as anchor points for the sequence alignment procedure. 
2. **Extension**: BLAST extends the seeds in both directions, creating larger alignments. This extension continues until the alignment score drops below a threshold, preventing poor alignments from extending.
3. **Alignment Scoring**: Each extended alignment is scored based on the similarity between the aligned regions, taking into account matches, mismatches, and gaps.
4. **Statistical Evaluation**: BLAST calculates the statistical significance of each alignment using e-values, which indicate how many alignments of the same quality as the evaluated alignment would be found by chance in a database of a given size.
6. **Output**: The algorithm then lists all alignments above a threshold score and provides details such as alignment positions, scores, and statistical significance.

## E-Values and Their Meaning

BLAST assesses the statistical significance of alignments using the Gumbel extreme value distribution (EVD) model. This model estimates the probability of an alignment score being due to chance. An e-value (expect value) is a statistical measure used in BLAST to assess the significance of an alignment:

- **Definition**: The e-value represents the number of alignments expected to occur by chance in a database of a given size.
- **Interpretation**: Lower e-values indicate more significant alignments. For example, an e-value of 0.01 suggests that this alignment quality would be obtained by chance 1 times out of hundred with the a query sequence of the same length of sequence and database size.

The e-values in BLAST searches provide a direct indication of alignment quality:

- **Significance Threshold**: Alignments with e-values below a certain threshold (e.g., 0.05) are considered significant, indicating a meaningful biological relationship.
- **Comparison**: E-values allow for comparing the statistical significance of different alignments, making them a valuable metric for researchers.
- **Database Size Influence**: The size of the database affects e-values, as larger databases increase the likelihood of chance alignments, resulting in higher e-values.

## How is the BLAST E-value Calculated?

The E-value (expect value) is a statistical measure used in BLAST to assess the significance of an alignment between a query sequence and database sequences. It reflects the expected number of alignments that would occur by chance in a given database search. The E-value is calculated based on the alignment score $S$, the search space size $m × n$, and parameters derived from the scoring system and database composition, such as the Karlin-Altschul parameters ($K$ and $λ$). The formula for the E-value is:

$E-value = Kmne^{-\lambdaS} $

Where:

- $m$ is the length of the query sequence.
- $n$ is the length of the database, which is the sum of the lengths of all the sequences in the database.
- $K$ and $λ$ are the Karlin-Altschul parameters. They can be estimated from large sets of random sequence alignments:
  - $λ$ normalizes the alignment score.
  - $K$ scales the E-value based on the database and sequence lengths.
- $S$ is the alignment score, calculated from the selected scoring matrix and the alignment of residues. It accounts for the sum of substitution and gap scores for the aligned residues.

The E-value is directly proportional to the search space size (m × n) and inversely proportional to the exponential function of the alignment score (S). Consequently, larger databases provide more opportunities for chance alignments, resulting in higher E-values (indicating weaker statistical significance) for the same level of sequence similarity.
